import{_ as le}from"../chunks/preload-helper.a4192956.js";import{s as ae,n as O,e as se}from"../chunks/scheduler.61d9df9b.js";import{S as re,i as ne,s as V,g as D,c as P,h as w,y as U,a as y,f as d,m as C,e as M,j as I,n as Q,x as g,o as R,C as ee,k as T,B as te}from"../chunks/index.e0afe235.js";import{p as oe,h as q,e as B,g as F,f as A,k as x}from"../chunks/audio-graph.c1b53150.js";import{p as pe}from"../chunks/stores.3fe21eb2.js";const ce=!1,Pe=Object.freeze(Object.defineProperty({__proto__:null,prerender:ce},Symbol.toStringTag,{value:"Module"}));function z(a,i,t){const e=a.slice();return e[15]=i[t],e}function G(a,i,t){const e=a.slice();return e[15]=i[t],e}function ue(a){var n;let i,t,e=((n=a[3])==null?void 0:n.PlaceDescriptions[0].display_label)+"",l,o,s,p;function b(u,c){var m;return((m=u[2])==null?void 0:m.serieses.length)>0?de:fe}let f=b(a),_=f(a);return{c(){i=D("h1"),t=C("Hello, "),l=C(e),o=C("!"),s=V(),_.c(),p=M()},l(u){i=w(u,"H1",{});var c=I(i);t=Q(c,"Hello, "),l=Q(c,e),o=Q(c,"!"),c.forEach(d),s=P(u),_.l(u),p=M()},m(u,c){y(u,i,c),g(i,t),g(i,l),g(i,o),y(u,s,c),_.m(u,c),y(u,p,c)},p(u,c){var m;c&8&&e!==(e=((m=u[3])==null?void 0:m.PlaceDescriptions[0].display_label)+"")&&R(l,e),f===(f=b(u))&&_?_.p(u,c):(_.d(1),_=f(u),_&&(_.c(),_.m(p.parentNode,p)))},d(u){u&&(d(i),d(s),d(p)),_.d(u)}}}function _e(a){let i,t="Hello... whoops, no ID";return{c(){i=D("h1"),i.textContent=t},l(e){i=w(e,"H1",{"data-svelte-h":!0}),U(i)!=="svelte-gn8eli"&&(i.textContent=t)},m(e,l){y(e,i,l)},p:O,d(e){e&&d(i)}}}function fe(a){let i,t="We don't have that data yet!";return{c(){i=D("h2"),i.textContent=t},l(e){i=w(e,"H2",{"data-svelte-h":!0}),U(i)!=="svelte-1ic68im"&&(i.textContent=t)},m(e,l){y(e,i,l)},p:O,d(e){e&&d(i)}}}function de(a){let i,t=A(a[2].serieses),e=[];for(let l=0;l<t.length;l+=1)e[l]=K(G(a,t,l));return{c(){i=D("div");for(let l=0;l<e.length;l+=1)e[l].c();this.h()},l(l){i=w(l,"DIV",{id:!0});var o=I(i);for(let s=0;s<e.length;s+=1)e[s].l(o);o.forEach(d),this.h()},h(){T(i,"id","chosen-serieses")},m(l,o){y(l,i,o);for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(i,null)},p(l,o){if(o&20){t=A(l[2].serieses);let s;for(s=0;s<t.length;s+=1){const p=G(l,t,s);e[s]?e[s].p(p,o):(e[s]=K(p),e[s].c(),e[s].m(i,null))}for(;s<e.length;s+=1)e[s].d(1);e.length=t.length}},d(l){l&&d(i),ee(e,l)}}}function J(a){let i,t,e,l,o,s,p=a[15].SeriesDescriptions[0].display_axis_primary+"",b,f,_,n,u;return{c(){i=D("div"),t=D("input"),o=V(),s=D("label"),b=C(p),_=V(),this.h()},l(c){i=w(c,"DIV",{});var m=I(i);t=w(m,"INPUT",{id:!0,type:!0}),o=P(m),s=w(m,"LABEL",{for:!0});var E=I(s);b=Q(E,p),E.forEach(d),_=P(m),m.forEach(d),this.h()},h(){T(t,"id",e="checkbox-"+a[15].SeriesDescriptions[0].display_axis_primary),T(t,"type","checkbox"),t.value=l=a[15].SeriesDescriptions[0].display_axis_primary,T(s,"for",f="checkbox-"+a[15].SeriesDescriptions[0].display_axis_primary)},m(c,m){y(c,i,m),g(i,t),g(i,o),g(i,s),g(s,b),g(i,_),n||(u=te(t,"change",a[8]),n=!0)},p(c,m){m&4&&e!==(e="checkbox-"+c[15].SeriesDescriptions[0].display_axis_primary)&&T(t,"id",e),m&4&&l!==(l=c[15].SeriesDescriptions[0].display_axis_primary)&&(t.value=l),m&4&&p!==(p=c[15].SeriesDescriptions[0].display_axis_primary+"")&&R(b,p),m&4&&f!==(f="checkbox-"+c[15].SeriesDescriptions[0].display_axis_primary)&&T(s,"for",f)},d(c){c&&d(i),n=!1,u()}}}function K(a){let i,t=a[15].SeriesValues.length>0&&J(a);return{c(){t&&t.c(),i=M()},l(e){t&&t.l(e),i=M()},m(e,l){t&&t.m(e,l),y(e,i,l)},p(e,l){e[15].SeriesValues.length>0?t?t.p(e,l):(t=J(e),t.c(),t.m(i.parentNode,i)):t&&(t.d(1),t=null)},d(e){e&&d(i),t&&t.d(e)}}}function me(a){let i,t="We don't have that data yet!";return{c(){i=D("h2"),i.textContent=t},l(e){i=w(e,"H2",{"data-svelte-h":!0}),U(i)!=="svelte-1ic68im"&&(i.textContent=t)},m(e,l){y(e,i,l)},p:O,d(e){e&&d(i)}}}function he(a){let i,t=A(a[2].serieses),e=[];for(let l=0;l<t.length;l+=1)e[l]=Z(z(a,t,l));return{c(){for(let l=0;l<e.length;l+=1)e[l].c();i=M()},l(l){for(let o=0;o<e.length;o+=1)e[o].l(l);i=M()},m(l,o){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(l,o);y(l,i,o)},p(l,o){if(o&38){t=A(l[2].serieses);let s;for(s=0;s<t.length;s+=1){const p=z(l,t,s);e[s]?e[s].p(p,o):(e[s]=Z(p),e[s].c(),e[s].m(i.parentNode,i))}for(;s<e.length;s+=1)e[s].d(1);e.length=t.length}},d(l){l&&d(i),ee(e,l)}}}function X(a){let i,t=a[15].SeriesDescriptions[0].display_axis_primary+"",e,l,o,s=x(a[15].value_format)(+a[15].SeriesValues[0].value)+"",p,b,f=(a[15].SeriesDescriptions[0].display_axis_secondary||"")+"",_,n,u,c,m,E,N,v,r=a[15].Metric.trend_scalar&&a[15].SeriesValues[0].trend&&Y(a);function S(h,k){return h[1][h[15].SeriesDescriptions[0].display_axis_primary].stopped?ve:ye}let L=S(a),H=L(a);function ie(...h){return a[9](a[15],...h)}return{c(){i=D("h2"),e=C(t),l=V(),o=D("p"),p=C(s),b=V(),_=C(f),n=V(),r&&r.c(),u=V(),c=D("button"),H.c(),m=V(),this.h()},l(h){i=w(h,"H2",{});var k=I(i);e=Q(k,t),k.forEach(d),l=P(h),o=w(h,"P",{});var j=I(o);p=Q(j,s),b=P(j),_=Q(j,f),j.forEach(d),n=P(h),r&&r.l(h),u=P(h),c=w(h,"BUTTON",{id:!0});var W=I(c);H.l(W),m=P(W),W.forEach(d),this.h()},h(){T(c,"id",E="play-button-"+a[15].SeriesDescriptions[0].display_axis_primary)},m(h,k){y(h,i,k),g(i,e),y(h,l,k),y(h,o,k),g(o,p),g(o,b),g(o,_),y(h,n,k),r&&r.m(h,k),y(h,u,k),y(h,c,k),H.m(c,null),g(c,m),N||(v=te(c,"click",ie),N=!0)},p(h,k){a=h,k&4&&t!==(t=a[15].SeriesDescriptions[0].display_axis_primary+"")&&R(e,t),k&4&&s!==(s=x(a[15].value_format)(+a[15].SeriesValues[0].value)+"")&&R(p,s),k&4&&f!==(f=(a[15].SeriesDescriptions[0].display_axis_secondary||"")+"")&&R(_,f),a[15].Metric.trend_scalar&&a[15].SeriesValues[0].trend?r?r.p(a,k):(r=Y(a),r.c(),r.m(u.parentNode,u)):r&&(r.d(1),r=null),L!==(L=S(a))&&(H.d(1),H=L(a),H&&(H.c(),H.m(c,m))),k&4&&E!==(E="play-button-"+a[15].SeriesDescriptions[0].display_axis_primary)&&T(c,"id",E)},d(h){h&&(d(i),d(l),d(o),d(n),d(u),d(c)),r&&r.d(h),H.d(),N=!1,v()}}}function Y(a){let i,t=$(+a[15].Metric.trend_scalar,+a[15].SeriesValues[0].trend)+"",e;return{c(){i=D("p"),e=C(t)},l(l){i=w(l,"P",{});var o=I(i);e=Q(o,t),o.forEach(d)},m(l,o){y(l,i,o),g(i,e)},p(l,o){o&4&&t!==(t=$(+l[15].Metric.trend_scalar,+l[15].SeriesValues[0].trend)+"")&&R(e,t)},d(l){l&&d(i)}}}function ye(a){let i;return{c(){i=C("Stop")},l(t){i=Q(t,"Stop")},m(t,e){y(t,i,e)},d(t){t&&d(i)}}}function ve(a){let i;return{c(){i=C("Play")},l(t){i=Q(t,"Play")},m(t,e){y(t,i,e)},d(t){t&&d(i)}}}function Z(a){let i,t=a[15].SeriesValues.length>0&&X(a);return{c(){t&&t.c(),i=M()},l(e){t&&t.l(e),i=M()},m(e,l){t&&t.m(e,l),y(e,i,l)},p(e,l){e[15].SeriesValues.length>0?t?t.p(e,l):(t=X(e),t.c(),t.m(i.parentNode,i)):t&&(t.d(1),t=null)},d(e){e&&d(i),t&&t.d(e)}}}function be(a){let i,t,e,l='<a href="/">Return Home</a>';function o(n,u){return n[0].id==null?_e:ue}let s=o(a),p=s(a);function b(n,u){var c;return((c=n[2])==null?void 0:c.serieses.length)>0?he:me}let f=b(a),_=f(a);return{c(){p.c(),i=V(),_.c(),t=V(),e=D("p"),e.innerHTML=l},l(n){p.l(n),i=P(n),_.l(n),t=P(n),e=w(n,"P",{"data-svelte-h":!0}),U(e)!=="svelte-12fru4v"&&(e.innerHTML=l)},m(n,u){p.m(n,u),y(n,i,u),_.m(n,u),y(n,t,u),y(n,e,u)},p(n,[u]){s===(s=o(n))&&p?p.p(n,u):(p.d(1),p=s(n),p&&(p.c(),p.m(i.parentNode,i))),f===(f=b(n))&&_?_.p(n,u):(_.d(1),_=f(n),_&&(_.c(),_.m(t.parentNode,t)))},i:O,o:O,d(n){n&&(d(i),d(t),d(e)),p.d(n),_.d(n)}}}function $(a,i){let t,e;switch(i){case 2:t="Improving Rapidly";break;case 1:t="Improving Slowly";break;case 0:t="Not Changing";break;case-1:t="Worsening Slowly";break;case-2:t="Worsening Rapidly"}switch(a){case-1:e="Lower";break;case 1:e="Higher"}if(e!==void 0&&t!==void 0)return`${e} numbers mean improvement and this metric is ${t}`}function ke(a,i,t){let e,l,o,s;se(a,pe,v=>t(7,s=v));let p,b,f={},_={},n={};async function u(v){t(6,p=(await le(()=>import(`./cities/${v}.json`),[],import.meta.url)).default),b=new URL("./sounds/keyboard-typing.mp3",self.location),p==null||p.data.serieses.forEach(r=>{r.SeriesValues.length>0&&(t(1,f[r.SeriesDescriptions[0].display_axis_primary]={tone:new q("sample_audio",{mono:b}),stopped:!0,data:r.SeriesValues,audioQueue:void 0},f),_[r.SeriesDescriptions[0].display_axis_primary]={min:r.display_min_value,max:r.display_max_value},n[r.SeriesDescriptions[0].display_axis_primary]={stream:new B,tone:new q("sample_audio",{mono:b}),data:[r.SeriesValues[0]],audioQueue:void 0})})}async function c(v){let r=v.target.value;if(v.target.checked){let S=_[r].min,L=_[r].max;n[r].stream.config.set("skipStartSpeech",!0),n[r].stream.config.set("skipScaleSpeech",!0),n[r].stream.config.set("skipStartPlaySpeech",!0),n[r].stream.config.set("skipFinishSpeech",!0),n[r].stream.config.set("skipStopSpeech",!0),n[r].stream.sampling.add(n[r].tone),n[r].stream.tone.set(overlay.tone),n[r].stream.data.set("name","data__1"),n[r].stream.data.set("values",overlay.data),n[r].stream.encoding.time.field("date","nominal").scale("band",2),n[r].stream.encoding.detune.field("value","quantitative").scale("polarity","positive").scale("domain",[S,L]).scale("range",[100,700]).format("0.4"),n[r].audioQueue=await F(n[r].stream.get()),await n[r].audioQueue.playQueue(),console.log(overlay)}}async function m(v){let r=new B;r.config.set("skipStartSpeech",!0),r.config.set("skipScaleSpeech",!0),r.config.set("skipStartPlaySpeech",!0),r.config.set("skipFinishSpeech",!0),r.config.set("skipStopSpeech",!0),t(1,f[v].stopped=!f[v].stopped,f);let S=f[v];S.audioQueue&&S.stopped?S.audioQueue.stopQueue():(r.name(v),r.sampling.add(S.tone),r.tone.set(S.tone),r.tone.continued(!1),r.data.set("name","data__1"),r.data.set("values",S.data),r.encoding.time.field("date","nominal").scale("band",1),r.encoding.detune.field("value","quantitative").scale("polarity","positive").scale("range",[100,700]).format("0.4"),S.audioQueue=await F(r.get()),console.log("audioQueue",S.audioQueue),console.log("stream.get():",r.get()),await S.audioQueue.playQueue(),t(1,f[v].stopped=!f[v].stopped,f))}const E=async v=>await c(v),N=async(v,r)=>await m(v.SeriesDescriptions[0].display_axis_primary);return a.$$.update=()=>{a.$$.dirty&128&&t(0,e=s.params),a.$$.dirty&1&&t(3,l=oe.data.places.find(v=>v.id==e.id)),a.$$.dirty&64&&t(2,o=p==null?void 0:p.data),a.$$.dirty&1&&typeof e.id=="string"&&u(e.id)},[e,f,o,l,c,m,p,s,E,N]}class Ce extends re{constructor(i){super(),ne(this,i,ke,be,ae,{})}}export{Ce as component,Pe as universal};
